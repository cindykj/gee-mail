<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>gee.mail</title>

<html>
	<head>
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet" media="screen">
		<script src="js/mail-generator.js"></script>

    <script>
     window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
		

    // Display the data from mail-generator.js
			// console.log(window.geemails);
			// insert forloop here
	

		for (var i = 0; i<window.geemails.length; i++){
			// console.log(window.geemails[i]);
			console.log(window.geemails[i].sender);
			console.log(window.geemails[i].subject);
			console.log(window.geemails[i].date);
			console.log(window.geemails[i].body);

	        var senderBox = document.createElement('div');
	        senderBox.className = 'emlSender';
	        senderBox.innerHTML = geemails[i].sender;
	        document.body.appendChild(senderBox);

	        var subjectBox = document.createElement('div');
	        subjectBox.className = 'emlSubject';
	        subjectBox.innerHTML = geemails[i].subject;
	        senderBox.appendChild(subjectBox);

	        var dateBox = document.createElement('div');
	        dateBox.className = 'emlDate';
	        dateBox.innerHTML = geemails[i].date;
	        senderBox.appendChild(dateBox);

	        var bodyBox = document.createElement('div');
	        bodyBox.className = 'emlBody';
	        bodyBox.innerHTML = geemails[i].body;
	        senderBox.appendChild(bodyBox);

		}

	// Click to show Body

		var parentBox = document.getElementsByClassName('emlSender');
		for (var i = 0; i<parentBox.length; i++){
			parentBox[i].addEventListener('click', showBody);
		}

		function showBody(){
			var bodyContent = this.querySelectorAll('.emlBody')[0];
			if (bodyContent.style.display === 'none'){
				bodyContent.style.display = 'block';
			}else{
				bodyContent.style.display = "none";
			}
			console.log('it works!');
		}

	// Unread emails are BOLDED; when clicked to display body, then the font returns to normal.

		var readEmail = document.getElementsByClassName('emlSubject');
		for (var i = 0; i<readEmail .length; i++){
			readEmail [i].addEventListener('click', unBold);
		}

		function unBold(){
			var subjectRead = this.querySelectorAll('.emlSubject')[0];
			if (readEmail.style.fontWeight === 'bold'){
				readEmail.style.fontWeight = 'normal';
			}else{
				readEmail.style.fontWeight = 'bold';
			}
		}

	// Inbox counter

		// console.log(window.geemails.length);
		// console.log(window.geemails[0]);

		// var inboxCounter = document.getElementById('counter');
		// inboxCounter.innerHTML = 'Inbox' + '(' + window.geemails.length + ')';

		function aNewMessage(){
			console.log('is it working?');
			var inboxCounter = document.getElementById('counter');
			inboxCounter.innerHTML = 'Inbox' + ' (' + window.geemails.length++ + ')';

		}

		function createNewMessage(){
			var compileMessage  = getNewMessage();

			var newSender = document.createElement('div');
			newSender.className = 'emlSender';
			newSender.innerHTML = compileMessage.sender;
			document.body.appendChild(newSender);

			// figure out the CSS
			var newSubject = document.createElement('div');
			newSubject.className = 'emlSubject';
			newSubject.innerHTML = compileMessage.subject;
			newSender.appendChild(newSubject);

			var newDate = document.createElement('div');
			newDate.className = 'emlDate';
			newDate.innerHTML = compileMessage.date;
			newSender.appendChild(newDate);

			var newBody = document.createElement('div');
			newBody.className = 'emlBody';
			newBody.innerHTML = compileMessage.body;
			newSender.appendChild(newBody);
		
			console.log(getNewMessage());
			// YOU MUST INVOKE THE FUNCTION!!!! HOW DO I DO THAT!!


			// var myNewMessage = getNewMessage();
			// console.log(myNewMessage);

			// var pElem = document.createElement('p');
			// pElem.innerHTML = createNewMessage.sender;
			// document.body.appendChild(pElem);

		}


		// var subjectBox = document.createElement('div')l

		setInterval(aNewMessage, 3000);
		setInterval(createNewMessage, 3000);

		// var myNewMessage = getNewMessage();
		// console.log(myNewMessage);

		// console.log(getNewMessage());

		// var myNewMessage = getNewMessage();
		// window.geemails.unshift(getNewMessage);

		// var inboxCounter = windows.geemails.length;
		// document.getElementbyId('counter').innerHTML = '(' + inboxCounter + ')';

		//This is Vic's example

		// console.log(getNewMessage());
		// var myNewMessage = getNewMessage();
		// console.log (myNewMessage);
		// console.log (myNewMessage.sender);
		// console.log (myNewMessage.subject);

		// var h1Elem = document.createElement('h1');
		// h1Elem.innerHTML = myNewMessage.sender;
		// main.appendChild(h1Elem);

		// var h1Elem = document.createElement('h1');
		// h1Elem.innerHTML = myNewMessage.subject;
		// main.appendChild(h1Elem);

		// var h1Elem = document.createElement('h1');
		// h1Elem.innerHTML = myNewMessage.sender;
		// main.appendChild(h1Elem);

 	};
 


    </script>
	</head>
	<body>
		<div class="container" id="main">
			<header id="intro">
				<h1 id="name">gee.mail</h1>
					<img id="logo" src="https://images.sftcdn.net/images/t_optimized,f_auto/p/4726ff4a-9b33-11e6-b705-00163ed833e7/1323208810/geemail-logo.png" alt="logo">
			<div class="content">
				<!-- <nav id="newMail">New Messages</nav> -->
				<div id="counter"> </div>


			</div>
		</div>

		 <script src="js/mail-generator.js"></script>
	</body>
</html>